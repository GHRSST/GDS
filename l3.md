---
jupytext:
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
---
(l3)=

<a id="section10"></a>

# Level 3 (L3) Product Specification

<a id="section10.1"></a>

## Overview description of the GHRSST L3 data product
GHRSST L3 data have been introduced to provide users with gridded, synthetic, and potentially adjusted SST products, bringing added value with respect to the original L2P but still allowing traceability to the original dataset. GHRSST L3 products do not use analysis or interpolation procedure to fill gaps where no observations are available. The GHRSST L3 products include:

- **Un-collated** data that represent a straightforward remapping of L2P GHRSST data granules to a space grid without combining any observations from overlapping orbits or times. Although in principle these data may or may not be adjusted to a reference sensor, in practice the un-collated L3 will normally be a remapped L2P dataset. For remapping best practices, see [Best Practices for Remapping Level 2 Data to a Fixed Grid](#section10.31). 
- **Collated** data that grid observations from a single instrument and a single platform into space and/or time bins. These data may or may not be adjusted to a reference sensor. For collating best practices see [Best Practices for Collating Data from the Same Sensor and Platform](#section10.32) and for adjustment best practices see [Best Practices for Adjustments](#section10.33). 
-	**Super-collated** data that combine observations from a multiple instruments into a space-time grid. In this case, the adjustment to a common reference is necessary to avoid heterogeneities in the resulting field. For best practices concerning the creation of super collated files see [Best Practices for Super-Collating Data from Multiple Sensors and Platforms](#section10.34).

As a result, the format of a L3 file will be able to cope with the three kinds of L3 SST presented above. The L3 format will include the following parts:

1) **In case the L3 is un-adjusted, a mandatory section containing the original L2P information** remapped onto the grid point: the original sea surface temperature, quality level and SSES information. An optional section including the remapping condition information may also be provided. These files are essentially gridded L2P files.
2) **In case the L3 is adjusted to a reference**, the adjusted SST value must be provided, together with the local bias to the reference, the error generated by the adjustment processing, and the overall error resulting from the combination of the SSES and the adjustment processing error.
3)	**In case the L3 is super-collated**, the source of SST at each pixel is mandatory.

**Un-adjusted files**: In the case of **un-collated or collated un-adjusted L3 files** the L3 file is derived from L2P data by a remapping process. The remapping and collating best practices are given in the [Best Practices for Remapping Level 2 Data to a Fixed Grid](#section10.31). Their content is thus identical to that of the L2P, but complementary, optional information on the remapping conditions may be provided.

**Adjusted files**: Collated files may or may not be adjusted, but a super-collated file is necessarily adjusted. The super-collating and adjustment best practices are described in [Best Practices for Collating Data from the Same Sensor and Platform](#section10.32) and [Best Practices for Adjustments](#section10.33). The principle governing this format is to allow traceability to the original L2P, while providing the best-adjusted SST value. A first section (**in blue in Table 10**) reproduces the original L2P SST and SSES information as in the un-adjusted version. The reference used to adjust the SST must be given in the “reference” attribute of the adjusted_sea_surface_temperature variable. The adjusted SST and some error information are also mandatory. This information **in yellow** in [Summary description of the contents within a GHRSST L3 data product](#table10-1) is: 

-	**adjusted_standard_deviation_error**: the total error resulting from the combination of the SSES error and the adjustment procedure error, **standard_deviation_to_reference_sst**.
-	**bias_to_reference_sst**: the local value of the estimated difference between the original SST and the reference SST
-	**standard_deviation_to_reference_sst**: an estimate of the error resulting from the adjustment procedure. If the procedure consists of analysing a field of differences of original SST and reference SST, the **standard_deviation_to_reference_sst** will be the error of this analysis.

The GHRSST Science Team determined that 5 mandatory fields will form the core data content of a GHRSST L3 data file. In addition to global attributes and geo-location information, RDACs must produce the following within a L3 file:

- Sea Surface temperature data (SST),
- Time of SST measurement,
- Bias and Standard Deviation error estimates for SST data,
- Data quality.

There are a number of optional fields that may be used at the data provider’s discretion that will form the core data content of a GHRSST data file ([Summary description of the contents within a GHRSST L3 data product](#table10-1)".

For every L3 file that is generated, appropriate ISO metadata (**specified in Overview description of the GMPE data product see Section 12.1**) must also be created and registered at the GHRSST Master Metadata Repository (MMR) system. The GHRSST L3 file contents are summarized in [Summary description of the contents within a GHRSST L3 data product](#table10-1) below.

<a id="table10-1"></a>

#### Summary description of the contents within a GHRSST L3 data product

| Description                                               | Required  | Relevant Section  |
|-----------------------------------------------------------|-----------|-------------------|
| Dimensions (e.g., i x j x k)                              | Mandatory | Section 8         |
| Global attributes                                         | Mandatory | Section 8.2       |
| [i *x* j *x* k] geolocation data                          | Mandatory | Section 8.4       |
| [i *x* j *x* k] array of SST data                         | Mandatory | Section 9.3       |
| [i *x* j *x* k] array of **sst_dtime** data               | Mandatory | Section 9.4       |
| [i *x* j *x* k] array of **sses_bias** data               | Mandatory | Section 9.5       |
| [i *x* j *x* k] array of **sses_standard_deviation** data | Mandatory | Section 9.6       |
| [i *x* j *x* k] array of **quality_level** data           | Mandatory | Section 9.18      |
| [i *x* j *x* k] array of optional/experimental data       | Optional  | Section 9.24      |

<a id="section10.2"></a>

## L3 data record format specification

<a id="section10.31"></a>

This table provides an overview of the GHRSST L3 product pixel data record that should be created for each input data. Within GHRSST L3 data files, there are many variables that are defined identically to their L2P counterparts. In addition, there are several variables that are unique to L3. Both types are listed below in [L3 SST data record content](#table10-2). In the following sections, each variable within the L3 data file that is unique to L3 is described in detail.

<a id="table10-2"></a>

#### L3 SST data record content

| Variable Name (Defintion Section, CDL Example)            | Description            | Unit type  |
|-----------------------------------------------------------|------------------------|------------|
| **sea_surface_temperature** (Section 9.3, Table 9-3)| SST measurement values from input L2 satellite data set. L2 SST data are not adjusted in any manner and are identical to the input data set. Use attribute **'sea_surface_temperature:source = "** < code from Section 7.9, **Error! Reference source not found.** >" to specify the L2 input product source.|kelvin int|
|**sst_dtime** [Variable sst_dtime](#section10.4), **Table9-5**| Deviation in time of SST measurement from reference time stored in the netCDF global variable **time** (defined as the start time of granule for L3U and the centre time of the collation window for L3C and L3S). Minimum resolution should be one second.|seconds long|
| **sses_bias** (Section 9.5,  Data producers are reminded to choose appropriate scale_factors and add_offsets for their data, and to strive for scale_factors as close to 0.01 as possible without “oversaturating” the values. Table 9 6)| Sensor Specific Error Statistic (SSES) bias error estimate generated by data provider. The specific SSES methodology should be described in L2P documentation from the data provider. The GHRSST ST-VAL TAG will maintain a summary document of all SSES schemes at http://www.ghrsst.org/STVAL-TAG-SSES-Schemes.html| kelvin byte|
|**sses_standard_deviation** (Section 9.6, Table 9 7)| SSES standard deviation uncertainty generated by data provider. The specific SSES methodology should be described in L2P documentation from the data provider. The GHRSST ST-VAL TAG will maintain a summary document of all SSES schemes at http://www.ghrsst.org/STVAL-TAG-SSES-Schemes.html| kelvin byte|
|**dt_analysis** (Section 9.7, Table 9 9)|The difference between input SST and a GHRSST L4 SST analysis from the previous 24 hour period. The GHRSST L4 analysis chosen for a given L2P data set variable should be consistent for all L2P products as far as practically possible. If no L4 analysis is available then an alternative L4 analysis or a reference mean SST climatology may be used. If storage as *byte* does not allow the provider to offer the full precision required for this field, storage as a *short* is optionally permitted though *byte* is preferred.|kelvin byte (or short)|
|**wind_speed** (Section 9.8, Table 9 10)|10 m surface wind speed near contemporaneous to the input SST measurement from satellite or analysis. Wind speed data should be provided at a minimum resolution of 1 ms-1 and data producers shall use **scale_factor** and **add_offset** to scale data to an appropriate resolution (higher resolution is better). The difference in time between SST measurement and **wind_speed** data shall be recorded in the L2P variable **wind_speed_dtime_from_sst**. If multiple sources of wind speed data are used, the variable **source_of_wind_speed** shall be used to indicate their source following the format requirements shown Section 7.9. Units of multiple sources of information shall be identical. If a unique source is used (this is recommended) the attribute ‘**wind_speed:source =** “< string defined following best practice in Section 7.9>” is considered sufficient.| ms<sup>-1</sup> byte|
|**wind_speed_dtime_from_sst</sub>** (Section 9.9, Table 9 11)|Time difference of **wind_speed** data from input L2 SST measurement specified in hours. Units of multiple sources of information shall be identical.|Hours byte|
|**source_of_wind_speed</sub>** (Section 9.10, Table 9 12)|When multiple sources of wind speed data are used in the variable **wind_speed**, the variable **source_of_wind_speed** shall be used to record the source of the wind speed data used. Units of multiple sources of information shall be identical. If a unique source of wind speed data is used (this is recommended) the variable attribute **'wind_speed:source =** "<string defined following best practice defined in Section 7.9>" shall be sufficient and the variable **source_of_wind_speed** Is not required.|Code byte|
|**sea_ice_fraction</sub>** (Section 9.11, Table 9 13)|Fractional Sea Ice contamination data. Ranges from 0 to 1. This field is only required if there is actually sea ice in the input L2 data set. Do not provide an array of missing data values. When multiple sources of sea ice fraction data are used in the variable **sea_ice_fraction**, the variable **source_of_sea_ice_fraction** shall be used to record the source of the sea ice fraction data used and the difference in time between SST measurement and **sea_ice_fraction** data shall be recorded in the variable sea_ice_fraction_dtime_from_sst. Units of multiple sources of information shall be identical. If a unique source of sea ice fraction data is used (this is recommended), the variable attribute **'sea_ice_fraction:source = "** < string defined following best practice defined in Section 7.9>" and an attribute **sea_ice_fraction:time_offset** = “difference time in hours” are considered sufficient and the variables **source_of_sea_ice_fraction** and **sea_ice_fraction_dtime_from_sst** are not required. |Percent byte|
|**sea_ice_fraction_dtime_from_sst</sub>** (Section 9.12, Table 9 14)|Time difference of **sea_ice_fraction** data from input L2 SST measurement specified in hours. This variable is mandatory when multiple sources of **sea_ice_fraction** are used. If only one source is used and the values all have one time, simply set a variable attribute **sea_ice_fraction:time_offset** = “difference time in hours”.|Hours byte|
|**source_of_sea_ice_fraction</sub>** (Section 9.13, Table 9 15)|When multiple sources of sea ice fraction data are used in the variable sea_ice_fraction, the variable **source_of_sea_ice_fraction** shall be used to record the source of the sea ice fraction data used. Units of multiple sources of information shall be identical. If a unique source of sea ice fraction data is used (this is recommended), the variable attribute **'sea_ice_fraction:source = "** < string defined following best practice defined in Section 7.9>" is sufficient and the variable **source_of_sea_ice_fraction** is not needed.|Code byte|
|**aerosol_dynamic_indicator</sub>** (Section 9.14, Table 9 16)|The variable **aerosol_dynamic_indicator** (ADI) is used to indicate the presence of atmospheric aerosols that may cause errors in the atmospheric correction of infrared satellite data when retrieving SST. The variable **aerosol_dynamic_indicator** is mandatory only when the input SST data set has been derived from an infrared satellite instrument. The atmospheric aerosol data used to fill the variable **aerosol_dynamic_indicator** is chosen by the data provider as the most appropriate aerosol indicator for a given input SST data set. (e.g., SDI might be used for MSG SEVIRI, a view difference might be used for AATSR, and aerosol optical depth may be used from a model or another satellite system). When multiple sources of atmospheric aerosol indicator data are used in the variable **aerosol_dynamic_indicator** , the variable **source_of_sea_aerosol_dynamic_indicator** shall be used to record the source of the aerosol indicator data used. Units of multiple sources of information shall be identical. If a unique source of atmospheric aerosol indicator data is used (this is recommended), the variable attribute **'aerosol_dynamic_indicator:source = "** < string defined following best practice defined in Section 7.9>" is sufficient and the variable **source_of_aerosol_dynamic_indicator** Is not required. If only one source is used and the values all have one time, simply set a variable attribute **sea_ice_fraction:time_offset** = “difference time in hours”. |Scaled value byte|
|**adi_dtime_from_sst</sub>** (Section 9.15, Table 9 17)|The time difference between the **aerosol_dynamic_indicator** value and SST measurement recorded in hours.|Hours byte|
|**source_of_adi</sub>** (Section 9.16, Table 9 18)|When multiple sources of atmospheric aerosol indicator data are used in the variable **aerosol_dynamic_indicator**, the variable **source_of_sea_aerosol_dynamic_indicator** shall be used to record the source of the aerosol indicator data used. If a unique source of atmospheric aerosol indicator data is used (this is recommended), the variable attribute **'aerosol_dynamic_indicator:source = "** <string defined following best practice defined in Section 7.9>" is sufficient and the variable **source_of_aerosol_dynamic_indicator** Is not required.|Code byte|
|**l2p_flags</sub>** (Section 9.17, Table 9 20)|The variable **l2p_flags** is used to (a) specify the type of input SST data (either infrared or passive microwave instrument derived), (b) pass through native flags from the input L2 SST data set and (c) record any additional information considered important for the user of an L3 data set. The variable **l2p_flags** is split into two sections: the first 6 bits of the L2P variable **l2p_flags** are generic flags that are common to all L3 data files; bits 6-15 are defined by the L3 data provider and are specific to each L3 input data stream. The tables below define the bit field and their meanings. <table border="1"><tr><td>**Bit**</td> <td>**Common Flags**</td></tr><tr><td>0</td><td>Passive microwave data</td></tr><tr><td>1</td><td>Land</td></tr><tr><td>2</td><td>Ice</td></tr><tr><td>3</td><td>Lake (if known)</td></tr><tr><td>4</td><td>River (if known)</td></tr><tr><td>5</td><td>Spare</td></tr></table> <table border="1"><tr><td>**Bit**</td> <td>**l2p_flags definition**</td></tr><tr><td>6-15</td><td>Defined by L2 data provider and described in the **flag_meanings**, <br> and **flag_masks** variable attributes. Please refer to <br> L2P data provider documentation</td></tr></table> |Flags int|
|**quality_level</sub>** (Section 9.18, Table 9 21)|The variable **quality_level** is used to provide an overall indication of L3 data quality. Variable **quality_level** will reflect CEOS QA4EO (Quality Indicator) guidelines. An incremental scale from 0 no data, 1 (bad e.g. cloud, rain, to close to land – under no conditions use this data) 2 (worst quality usable data), to 5 (best quality usable data) shall be used.|Code byte|
|**or_latitude** [Variable or_latitude](#section10.20), [CDL example description of or_latitude variable](#table10-3)|Original latitude of the satellite measurement as provided in the L2P|Degree short|
|**or_longitude** [Variable or_longitude](#section10.21), [Table CDL example description of or_longitude variable](#table10-4)|Original longitude of the satellite measurement as provided in the L2P |Degree short|
|**or_number_of_pixels** [Variable or_number_of_pixels](#section10.22), [CDL example description of or_number_of_pixels variable](#table10-5)|Number of original pixels from the L2P contributing to the binned (space and/or time) average|Number short|
|**sum_sst** [Varible sum_sst](#section10.23),  [Table 10-6](#table10-6) |Sum of the pixel values going into the space and/or time bin |kelvin float|
|**sum_square_sst** [Variable sum_square_sst](#section10.24), [CDL example description of sum_square_sst variable](#table10-7) |Sum of the pixel value squares going into the space and/or time bin |kelvin2 float|
|**adjusted_sea_surface_temperature** [Variable adjusted_sea_surface_temperature](#section10.5), [CDL example description of adjusted_sea_surface_temperature variable](#table10-8)) |SST adjusted to the reference. Mandatory for adjusted type file |kelvin short|
|**adjusted_standard_deviation_error** [Variable adjusted_standard_deviation_error](#section10.26), [CDL example description of adjusted_standard_deviation_error variable](#table10-9)|Total error standard deviation estimate derived from SSES and adjustment method. Mandatory for adjusted type file |kelvin byte|
|**bias_to_reference_sst** [Variable bias_to_reference_sst](#section10.27), [CDL example description of bias_to_reference_sst variable](#table10-10)|Bias error derived from comparison with the reference. Mandatory for adjusted type file |kelvin short|
|**standard_deviation_to_reference_sst** [Variable standard_deviation_to_reference_sst](#section10.28), [CDL example description of standard_deviation_to_reference_sst variable](#table10-11)|Error standard deviation resulting from the bias estimation method. Mandatory for adjusted type file |kelvin byte|
|**source_of_sst** [Variable standard_deviation_to_reference_sst](#section10.29), [CDL description of source_of_sst variable](#table10-12)|Source of SST data. Mandatory for super-collated type file |Code byte|
|Optional/experimental fields defined by data provider (Section 9.24, Table 9 28)|Optional/experimental data|Defined by RDAC|

<a id="section10.3"></a>

## Variable sea_surface_temperature

Defined identically to L2P variable of the same name. See Section 9.3 for more details.

<a id="section10.4"></a>

## Variable sst_dtime

Defined identically to L2P variable of the same name except the storage type is long instead of short. See Section 9.4.

<a id="section10.5"></a>

## Variable sses_bias

Defined identically to L2P variable of the same name. See Section 9.5.

<a id="section10.6"></a>

## Variable sses_standard_deviation

Defined identically to L2P variable of the same name. See Section 9.6.

<a id="section10.7"></a>

## Variable dt_analysis

Defined identically to L2P variable of the same name. See Section 9.7.

<a id="section10.8"></a>

## Variable wind_speed 

Defined identically to L2P variable of the same name. See Section 9.8.

<a id="section10.9"></a>

## Variable wind_speed_dtime_from_sst 

Defined identically to L2P variable of the same name. See Section 9.9.

<a id="section10.10"></a>

## Variable source_of_wind_speed 

Defined identically to L2P variable of the same name. See Section 9.10.

<a id="section10.11"></a>

## Variable sea_ice_fraction 

Defined identically to L2P variable of the same name. See Section 9.11.

<a id="section10.12"></a>

## Variable sea_ice_fraction_dtime_from_sst 

Defined identically to L2P variable of the same name. See Section 9.12.

<a id="section10.13"></a>

## Variable source_of_sea_ice_fraction 

Defined identically to L2P variable of the same name. See Section 9.13.

<a id="section10.14"></a>

## Variable aerosol_dynamic_indicator 

Defined identically to L2P variable of the same name. See Section 9.14.

<a id="section10.15"></a>

## Variable adi_dtime_from_sst

Defined identically to L2P variable of the same name. See Section 9.15.

<a id="section10.16"></a>

## Variable source_of_adi

Defined identically to L2P variable of the same name. See Section 9.16.

<a id="section10.17"></a>

## Variable l2p_flags

Defined identically to L2P variable of the same name. See Section 9.17.

<a id="section10.18"></a>

## Variable quality_level 

Defined identically to L2P variable of the same name. See Section 9.18.

<a id="section10.19"></a>

## Optional or experimental L3 variables included by data provider

Defined similarly to experimental L2P variables. See Section 9.24.

<a id="section10.20"></a>

## Variable or_latitude

The variable ‘**or_latitude**’ will be included either:

- As a floating point variable similarly to the grid latitude and longitude
- As a short variable with the format requirements shown in [CDL example description of or_latitude variable](#table10-3), if the required precision is compatible.

This variable is the original latitude of the contributing pixel in case of remapping to the nearest pixel, or the average latitude of the contributing pixels in case of averaging.

<a id="table10-3"></a>

#### CDL example description of or_latitude variable

| Storage type | Name             | Description            | Unit   |
|--------------|------------------|------------------------|--------|
|short|**or_latitude**|Original latitude of the satellite measurement|degree|
|**CDL Description**|
|**short or_latitude(time, lat, lon);<br> or_latitude:long_name = "original latitude of the SST value";<br> or_latitude:standard_name = “latitude”;<br> or_latitude:units = "degrees_north";<br> or_latitude:_FillValue = -32768s;<br> or_latitude:valid_range = -9000s, 9000s ;<br><br> or_latitude:add_offset = 0.0f ;<br> or_latitude:scale_factor = 0.01f ;<br> or_latitude:comment = “Original latitude of the SST value” ;**|
|**Comments**|
|<br>|

<a id="section10.21"></a>

## Variable or_longitude

The variable **‘or_longitude’** shall be included either 

- As a floating point variable similarly to the grid latitude and longitude
- As a short variable with the format requirements shown in [CDL example description of or_longitude variable](#table10-4), if the required precision is compatible.

This variable is the original longitude of the contributing pixel in case of remapping to the nearest pixel, or the average longitude of the contributing pixels in case of averaging.
 of averaging.

<a id="table10-4"></a>

#### CDL example description of or_longitude variable

| Storage type | Name             | Description            | Unit   |
|--------------|------------------|------------------------|--------|
|short|**or_longitude**|Original longitude of the satellite measurement|degree|
|**CDL Description**|
|**short or_longitude(time, lat, lon);<br> or_longitude:long_name = "original longitude of the SST value";<br> or_longitude:standard_name = “longitude”;<br> or_longitude:units = "degrees_east";<br> or_longitude:_FillValue = -32768s;<br> or_longitude:valid_range = -18000s, 18000s ;<br><br> or_longitude:add_offset = 0.0f ;<br> or_longitude:scale_factor = 0.01f ;<br> or_longitude:comment = “Original longitude of the SST value” ;**
|**Comments**|
|<br>|

<a id="section10.22"></a>

## 10.22	 Variable or_number_of_pixels

The variable ‘**or_number_of_pixels**‘ shall be included with the format requirements shown in [CDL example description of or_number_of_pixels variable](#table10-5).

<a id="table10-5"></a>

#### CDL example description of or_number_of_pixels variable

| Storage type | Name             | Description            | Unit   |
|--------------|------------------|------------------------|--------|
|short|**or_number_of_pixels**|Number of pixels from the L2P contributing to the SST value|none|
|**CDL Description**|
|**short or_number_of_pixels(time, lat, lon) ;<br> or_number_of_pixels:long_name = "number of pixels from the L2Ps contributing to the SST value" ;<br> or_number_of_pixels:units = "1" ;<br> or_number_of_pixels:_FillValue = -32768s;<br> or_number_of_pixels:valid_range = 0, 32767s ;<br> or_number_of_pixels:comment = “Original number of pixels from the L2Ps contributing to the SST value” ;**
|**Comments**|
|This variable records the number of original L2P pixels contributing to the SST in case of averaging during the L3 fabrication.|

<a id="section10.23"></a>

## Variable sum_sst

The variable ‘**sum_sst**’ shall be included with the format requirements shown in [CDL example description of sum_sst variable](#table10-6).

<a id="table10-6"></a>

#### CDL example description of sum_sst variable

| Storage type | Name             | Description            | Unit   |
|--------------|------------------|------------------------|--------|
|float|	**sum_sst**	|Sum of the pixel values going into the space and/or time bin	|kelvin|
|**CDL description**|
|**float sum_sst(time, lat, lon) ;<br> sum_sst:long_name = "sum of contributing pixel sst values" ;<br> sum_sst:_FillValue = -99999f ;<br> sum_sst:units = "kelvin" ;<br> sum_sst:valid_range = -200.0f, 200.0f;<br>  sum_sst:comment = "Sum of orginal contributing pixel sst values" ;**  <br>
|**Comments**|
|This variable records the sum of the original SST values in case of averaging during the L3 fabrication.|

<a id="section10.24"></a>

## Variable sum_square_sst

The variable ‘**sum_square_sst**’ shall be included with the format requirements shown in [CDL example description of sum_square_sst variable](#table10-7).

<a id="table10-7"></a>

#### CDL example description of sum_square_sst variable

| Storage type | Name             | Description            | Unit   |
|--------------|------------------|------------------------|--------|
|float|	**sum_square_sst**	| Sum of the pixel value squares going into the space and/or time bin 	|kelvin**2|
|**CDL description**|
|**float sum_square_sst(time, lat, lon) ;<br> sum_ square_sst:long_name = "sum of contributing pixel sst value squares" ;<br> sum_ square_sst:standard_name = sum_of_contributing_pixel_sst_value_squares_D;<br> sum_ square_sst:_FillValue = -1f ;<br> sum_ square_sst:units = "kelvin2" ;<br> sum_ square_sst:valid_range = 0.0f, 50000.0f;<br> sum_ square_sst:comment = "Sum of contributing pixel sst value squares" ;**|	
|**Comments**|
|This variable records the sum of squares of the original SST values in case of averaging during the L3 fabrication|

<a id="section10.25"></a>

## Variable adjusted_sea_surface_temperature

The variable ‘**adjusted_sea_surface_temperature**’ shall be included with the format requirements shown in [CDL example description of adjusted_sea_surface_temperature variable](#table10-8). see the principles of the adjustment procedure in [Best Practices for Adjustments](#section10.33).

<a id="table10-8"></a>

#### CDL example description of adjusted_sea_surface_temperature variable

| Storage type | Name             | Description            | Unit   |
|--------------|------------------|------------------------|--------|
|short|	**adjusted_sea_surface_temperature**|	SST values after adjustment to the reference|	kelvin
|**CDL description**|
|**short adjusted_sea_surface_temperature(time, lat, lon) ;<br> adjusted_sea_surface_temperature:long_name = "adjusted sea surface temperature" ;<br> adjusted_sea_surface_temperature:standard_name = sea_surface_skin_temperature, sea_surface_subskin_temperature or sea_surface_foundation_temperature " ;<br> adjusted_sea_surface_temperature:units = "kelvin" ;<br> adjusted_sea_surface_temperature:_FillValue = -32768s ;<br> adjusted_sea_surface_temperature:add_offset = 273.15f ;<br> adjusted_sea_surface_temperature:scale_factor = 0.01f ;<br> adjusted_sea_surface_temperature:valid_range = -300s, 4500s ;<br> adjusted_sea_surface_temperature:reference="ATS_NR_2P" ;<br> adjusted_sea_surface_temperature:comment="Priorities: example: ATS_NR_2P, AVHRRMTA, NAR17_SST, NAR18_SST, AVHRR17_L, AVHRR_18_L, AVHRR17_L, AVHRR18_G, SEVIRI_1H_SST, GOES_12_1H_SST, AMSRE, TMI, MODIS_A, MODIS_T"**|
|**Comments**|
|This variable records the sum of squares of the original SST values in case of averaging during the L3 fabrication|

<a id="section10.26"></a>

## Variable adjusted_standard_deviation_error

The variable ‘**adjusted_standard_deviation_error**’ shall be included with the format requirements shown in [CDL example description of adjusted_standard_deviation_error variable](#table10-9). This variable represents the total error associated with the **adjusted_sea_surface_temperature** variable. It represents the accumulated error of the SST production (the **sses_standard_deviation**) and the SST adjustment (**standard_deviation_to_reference_sst**).

<a id="table10-9"></a>

#### CDL example description of adjusted_standard_deviation_error variable

| Storage type | Name             | Description            | Unit   |
|--------------|------------------|------------------------|--------|
|byte|	**adjusted_standard_deviation_error**	|Total error standard deviation estimate derived from SSES and adjustment method|	kelvin|
|**CDL description**|
|**byte adjusted_standard_deviation_error(time, lat, lon) ;<br> adjusted_standard_deviation_error:long_name = "standard deviation error based on L2P SSES and adjustment method" ;<br> adjusted_standard_deviation_error:units = "kelvin" ;<br> adjusted_standard_deviation_error:_FillValue = -128b ;<br> adjusted_standard_deviation_error:add_offset = 1.0f ;<br> adjusted_standard_deviation_error:scale_factor = 0.01f ;<br> adjusted_standard_deviation_error:valid_range = -127b, 127b ;<br>  adjusted_standard_deviation_error:comment = "Cumulated errors of SSES and adjustment method" ;**|
|**Comments**|
|This represents the cumulated errors of SSES and adjustment method |

<a id="section10.27"></a>

## Variable bias_to_reference_sst

The variable ‘**bias_to_reference_sst**’ shall be included with the format requirements shown in [CDL example description of bias_to_reference_sst variable](#table10-10). This quantity represents the local value of the adjustment to the reference.

<a id="table10-10"></a>

#### CDL example description of bias_to_reference_sst variable

| Storage type | Name             | Description            | Unit   |
|--------------|------------------|------------------------|--------|
|short|	**bias_to_reference_sst**	|Bias error derived from comparison with the reference|	kelvin|
|**CDL description**`|
|**short bias_to_reference_sst (time, lat, lon) ;<br> bias_to_reference_sst:long_name = "bias error derived from reference" ;<br> bias_to_reference_sst:units = "kelvin" ;<br> bias_to_reference_sst:_FillValue = -32768s ;<br> bias_to_reference_sst:add_offset = 0.0f ;<br> bias_to_reference_sst:scale_factor = 0.01f ;<br> bias_to_reference_sst:valid_range = -32767s, 32767s ;<br> bias_to_reference_sst:valid_max = 32767s;<br> bias_to_reference_sst:comment = "Bias estimate derived from comparison between the original SST (native SSES being applied) and the reference sensor SST (original SST - reference SST)" ;**|
|**Comments**|
|This represents the bias estimate derived from comparison between the original SST (native SSES being applied) and the reference sensor SST (original SST - reference SST)|

<a id="section10.28"></a>

## Variable standard_deviation_to_reference_sst

The variable ‘standard_deviation_to_reference_sst’ shall be included with the format requirements shown in [CDL example description of standard_deviation_to_reference_sst variable](#table10-11).

<a id="table10-11"></a>

#### CDL example description of standard_deviation_to_reference_sst variable

| Storage type | Name             | Description            | Unit   |
|--------------|------------------|------------------------|--------|
|byte	|standard_deviation_to_reference_sst|	Error standard deviation resulting from the bias estimation method|	kelvin|
|**CDL description**|
|byte standard_deviation_to_reference_sst(time, lat, lon) ;<br> standard_deviation_to_reference_sst:long_name = "standard deviation of the reference error" ;<br> standard_deviation_to_reference_sst:units = "kelvin" ;<br> standard_deviation_to_reference_sst:_FillValue = -128b ;<br> standard_deviation_to_reference_sst:add_offset = 1.0f ;<br> standard_deviation_to_reference_sst:scale_factor = 0.01f ;<br> standard_deviation_to_reference_sst:valid_range = -127b, 127b ;<br> standard_deviation_to_reference_sst:comment = "This represents the error standard deviation estimate resulting from the bias estimation method" ;
|**Comments**|
|This represents the error standard deviation estimate resulting from the bias estimation method|

<a id="section10.29"></a>

## Variable source_of_sst 

In a super-collated file (L3S), the variable ‘**source_of_sst**’ shall be included with the format requirements shown in [CDL description of source_of_sst variable](#table10-12).

<a id="table10-12"></a>

#### CDL description of source_of_sst variable

| Storage type | Name             | Description            | Unit   |
|--------------|------------------|------------------------|--------|
|byte|	**source_of_sst**|	Origin of the SST at pixel level|	Code table|
|**CDL description**|
|**byte source_of_sst(time, lat, lon) ;<br> source_of_sst:long_name = "SST product origin" ;<br> source_of_sst:_FillValue = -128b ;<br> source_of_sst:flag_meanings = "AVHRR_SST_METOP_B-OSISAF-L2P-v1.0 VIIRS_NPP-OSPO-L2P-v2.61 VIIRS_N20-OSPO-L2P-v2.61 SLSTRA_MAR_L2P_v1.0 SLSTRB_MAR_L2P_v1.0 SEVIRI_SST-OSISAF-L3C-v1.0 GOES16-OSISAF-L3C-v1.0 ABI_G17-STAR-L3C-v2.71 SEVIRI_IO_SST-OSISAF-L3C-v1.0 AHI_H08-STAR-L3C-v2.7 AMSR2-REMSS-L2P-v8a" ;<br> source_of_sst:flag_values = 70b, 20b, 21b, 80b, 81b, 41b, 52b, 53b, 42b, 85b, 60b ;** 
|**Comments**|
|<br>|

<a id="section10.30"></a>

## Sample GHRSST L3 file (CDL header)

A complete CDL description of a L3S dataset derived from infrared VIIRS sensors on S-NPP, and NOAA-20 platforms (https://doi.org/10.5067/GHLPM-3SS28) is given below. It includes some non-standard variables and attributes. 

**ADD INFO HERE**

<a id="section10.31"></a>

## Best Practices for Remapping Level 2 Data to a Fixed Grid 

The remapping procedure consists in remapping the original L2P in swath projection onto a fixed grid. This remapping should preserve the traceability of the SST at pixel level and keep the best quality data. 

If the original and final grid resolutions are similar, the nearest pixel remapping should be adopted. To do so, either a “source to target” or a “target to source” approach may be used. The latter, target to source, which consists in scanning the target grid points to find the nearest pixel in the source, is recommended since it avoids creating holes in the remapped field. 

If the original grid resolution is finer than the output grid, (Figure 10 4) an averaging procedure can be adopted. For these cases the best practice is to average the values of all pixels which overlap the product cell entirely and which have a L2P confidence record **quality_level** value equal to the highest encountered within the cell, to produce a single value.

<p align="center"><img src="https://github.com/user-attachments/assets/7c3134c8-34d1-40b1-9239-b618c27fe183" alt=Figure 10 4: To illustrate the approach when the L3 product output grid is over-sampled by the L2P input data. All pixels labeled p in the input data are possible contributors to the value for new cell A./></p>

<a id="figure10-4"></a>

#### <p align="center"> To illustrate the approach when the L3 product output grid is over-sampled by the L2P input data. All pixels labeled p in the input data are possible contributors to the value for new cell A. 

The following practices are recommended by the GDS:

1) In the case of a smaller L2P input pixel than the grid cell size, L3 data product cell values are derived from an average of the L2P pixel which completely overlap the product cell and which have a L2P quality record **quality_level** value equal to the highest encountered within the cell, to produce a single value.
2) For input pixels that straddle the boundary between output grid cells, a weighting function may be applied to the input values according to the degree of coverage of the output grid cell and according to the SSES.
3) Only the best quality original data within a grid cell should be averaged to produce the resulting SST value, to preserve the homogeneity of the SST quality (recommendation 1 above). In the case of averaging, the number of contributors can be recorded as well as the sum of the SST values and the sum of the square values of the SST. The SSES and ancillary data (if needed, for instance if there may be more that one SSES couple of values (bias and standard deviation) by quality level) must be averaged accordingly: the **sses_bias** values are averaged similarly as the SST values, the new **sses_standard_deviation** value is the square root of the averaged squared values of the contributing **sses_standard_deviations**. The averaging should account for the nature of the original **l2p_flags**.
4) In the case of a larger pixel than the L3 grid cell size, 2 approaches can be adopted:
   <br>1. The value of the L2P pixel is allocated to the grid cell the closest to the pixel centre.
   <br>2. The output grid cell takes the value of the L2P pixel in which its centre lies. In this case the original latitudes and longitudes of the pixel must be recorded, to be able to detect where the original L2P pixel value has been duplicated.  

If the original grid resolution is larger than the output grid (e.g., microwave instruments), as illustrated in Figure 10 5, the following practices are recommended by the GDS:

<p align="center"><img src="https://github.com/user-attachments/assets/eec3e145-fc98-4093-9c65-bba6f1d4c00f"/></p>

<a id="figure10-5"></a>

#### <p align="center"> To illustrate the approach when the L3 output grid is under-sampled by the L2P data. Either Grid cell C is assigned the value of pixel p, Or grid cell A is assigned the value of pixel p and grid cell B is assigned the weighted average of p and q provided they both have quality flags with the same rating.

<a id="section10.32"></a>

## Best Practices for Collating Data from the Same Sensor and Platform 

The collating procedure consists of gathering over a unique grid several orbits or slots (in the case of a geostationary satellite) of the same sensor on the same platform. This process is often known as “binning” the data. The collating procedure merges data with different times of observation.

1)	For situations in which the collation is to be done for data collected within the same day, two cases are met in practice: collation of consecutive orbits in the case of data collected from polar orbiting sensors, or the merging of consecutive slots in the case of geostationary satellites. In both cases there may be multiple candidates for a grid cell. 
a.	To collate observations from overlapping orbits of the polar orbiting sensors, the selection procedure should prioritize data first by using the highest available quality data. If multiple observations share the same highest quality, one of two approaches should be taken: either the observation with the minimum satellite zenith angle should be selected, or the observations should be averaged. If the minimum satellite zenith angle approach is taken, the corresponding **sses_bias** and **sses_standard_deviation** should be selected as well. If the averaging approach is followed, the **sses_bias** and sses_standard_deviation should be averaged similarly (note that the new sses_standard_deviation value is the square root of the averaged squared values of the contributing sses_standard_deviation values). Also in the case of averaging, it is good practice to record the number of observations being averaged, the sum of the SST values, and the sum of the squared SST values. These values can be stored in the **or_number_pixels**, **sum_sst**, and **sum_square_sst** variables listed in Sections and 8 and 9.
b.	In the case of geostationary data, the selection procedure must prioritize data showing the best quality level, and if equal, data closest to the representative time (central time) of the L3 time window. In the case of geostationary satellites, remapping is not a preliminary step to the collating procedure. 
2)	 If averaging over multiple days, only the best quality original data within a grid cell should be averaged to produce the resulting SST value, to preserve the homogeneity of the SST quality. The number of contributors can be recorded (**or_number_pixels**) as well as the sum of the SST values (**sum_sst**) and the sum of the square values of the SST (**sum_square_sst**). The SSES values should be averaged accordingly: the **sses_bias** values are averaged in the same manner as the SST values and the new **sses_standard_deviation** value is the square root of the averaged squared values of the contributing **sses_standard_deviation** values. The averaging should preserve the nature of the original **L2P_flags**.

<a id="section10.33"></a>

## Best Practices for Adjustments 

Most of individual sensors show regional biases resulting in limitations of the applied algorithms. The objective of the adjustment procedure is to provide a correction to these regional biases by comparison with a “reference sensor”, supposedly free from such biases. A variety of sources can be adopted as references in the adjustment procedure, ranging from AATSR or in situ measurement to using a median of sensors approach. The adopted reference must be recorded in the **adjusted_sea_surface_temperature** variable “reference” attribute. 
The adjustment procedure includes the following steps:

1.	application of the SSES,
2.	determination of the bias adjustment to the reference,
3.	evaluation of the error of the adjustment procedure 

NB: A skin to subskin conversion may be needed. In that case, please refer to the STVAL recommendations. The type of the SST variables must be recorded in the standard_names of the **sea_surface_temperature** and **adjusted_sea_surface_temperature** variables. The bias adjustment value at pixel and the error of the adjustment procedure must be recorded in the corresponding variables (mandatory).

<a id="section10.34"></a>

## Best Practices for Super-Collating Data from Multiple Sensors and Platforms

The building of a super-collated file takes place by merging adjusted collated L3 files from various sensors over the same grid and over the same time window. There is one input candidate file (and hence one candidate observation) per sensor. There may be multiple candidates for a given grid cell originating from different sensors. To make the selection from among the candidates, a “decision tree” or selection hierarchy should be established a priori. This hierarchy depends on the objective of the super-collation procedure, and may be quite different for a moderate resolution (10km) super-collated over 24h aiming to feed a foundation SST analysis and for a high resolution (2km) hourly subskin SST super-collated aiming to feed a diurnal warming analysis, for example. Because the hierarchy must be established based on the intended use of the super-collated dataset that results, it is out of the scope of this document to define any single hierarchy. However, the adopted hierarchy must be described in the **comment** attribute of the **adjusted_sea_surface_temperature** variable. In addition, it is mandatory to provide the source of the SST (**source_of_sst**) at the grid cell level.
